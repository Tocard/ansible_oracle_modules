---

- name: "define connection parameters"
  set_fact:
    connection_parameters: &con_param
      oracle_home: "{{ oracle_home }}"  

- name: 'Connection paramters - see or use integration_config.yml.template'
  debug:
    var: connection_parameters
    
# - name: 'drop database'
#   oracle_db:
#     <<: *con_param
#     sid: "TESTPDB"
#     db_name: "TESTPDB"
#     state: absent
#   register: _
#   failed_when: _.failed

- name: 'create database minimal config - requires GI'
  oracle_db:
    <<: *con_param
    sid: "TESTPDB"
    db_name: "TESTPDB"
    storage_type: ASM
    datafile_dest: +XDATA
    recoveryfile_dest: +XDATA
    sys_password: X43ofljfksjfkhfr3fkh
    state: present
  register: _
  failed_when: _.failed

- name: 'no change database minimal config'
  oracle_db:
    <<: *con_param
    sid: "TESTPDB"
    db_name": "TESTPDB"
    storage_type: ASM
    datafile_dest: +XDATA
    recoveryfile_dest: +XDATA
    sys_password: X43ofljfksjfkhfr3fkh
    state: present
  register: _
  failed_when: _.failed
  
...
